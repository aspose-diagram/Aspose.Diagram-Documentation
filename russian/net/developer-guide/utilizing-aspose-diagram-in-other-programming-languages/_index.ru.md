---
title: Использование Aspose.Diagram на других языках программирования
type: docs
weight: 120
url: /ru/net/utilizing-aspose-diagram-in-other-programming-languages/
description: На этой странице описывается, как использовать Aspose.Diagram на других языках программирования.
---
## **Используйте Aspose.Diagram for .NET через COM-взаимодействие**
 Информация в этом разделе относится к сценариям, в которых разработчикам требуется использовать[Aspose.Diagram for .NET](/diagram/ru/net/home/) через COM Interop на любом поддерживаемом языке.
### **Работа с COM-взаимодействием**
Aspose.Diagram for .NET выполняется под управлением .NET Framework, и это называется управляемым кодом. Код, написанный на всех языках, работающих за пределами .NET Framework, называется неуправляемым кодом. Взаимодействие между неуправляемым кодом и Aspose.Diagram происходит через средство .NET, называемое COM Interop.

Объекты Aspose.Diagram — это объекты .NET, но при использовании через COM-взаимодействие они отображаются как COM-объекты в вашем языке программирования. Поэтому лучше всего убедиться, что вы знаете, как создавать и использовать COM-объекты в вашем языке программирования, прежде чем вы начнете использовать[Aspose.Diagram for .NET](/diagram/ru/net/home/).

- В мире COM мы различаем COM-сервер и COM-клиент. COM-сервер хранит COM-классы, а COM-клиент запрашивает у COM-сервера экземпляры классов, то есть COM-объекты.
-  COM-клиент или просто клиентское приложение может что-то знать о содержимом COM-класса или вообще не знать о его методах и свойствах. Поэтому клиентское приложение может обнаружить структуру класса COM при компиляции/сборке или только во время выполнения. Процесс «открытия» известен как связывание, поэтому мы имеем**раннее связывание** а также**позднее связывание**.
- вкратце COM-класс подобен черному ящику и для работы с ним нужна библиотека типов, в этом бинарном файле есть описание методов, свойств класса COM и любой язык высокого уровня, который поддерживает работу с COM-объектами, часто имеет синтаксическое выражение для добавления библиотеки типов, для пример это[**#импорт**](http://msdn.microsoft.com/en-us/library/8etzzkb6.aspx) в C++.
- библиотека типов используется для раннего связывания.
-  COM-объект может раскрывать свои методы и свойства двумя способами: с помощью**диспетчерский интерфейс** (dispinterface) и в его**виртуальная таблица** (виртуальная таблица функций).
-  внутри**дисп-интерфейс** , каждый метод и свойство идентифицируются уникальным членом; этот член является идентификатором отправки функции (или**DispID**).
- **виртуальная таблица** это всего лишь набор указателей на функции, поддерживаемые интерфейсом COM-класса.
-  объект, который предоставляет свои методы через оба интерфейса, поддерживает**двойной интерфейс**.
- преимущества есть у обоих типов переплета. Раннее связывание обеспечивает повышенную производительность и проверку синтаксиса во время компиляции. Позднее связывание наиболее выгодно, когда вы пишете клиентов, которые вы собираетесь использовать.***совместим с будущими версиями*** вашего COM-класса. При позднем связывании информация из библиотеки типов не "зашита" в ваш клиент, поэтому вы можете быть более уверены, что ваш клиент сможет работать с будущими версиями класса COM без изменения кода.
-  Механизм позднего связывания имеет большое преимущество: если создатель COM-DLL решит выпустить новую версию с другим макетом интерфейса функций, любой код, вызывающий эти методы, не рухнет, если только эти методы больше не будут доступны; даже если**виртуальная таблица**отличается тем, что позднему связыванию удается обнаружить новые DISPID и вызвать соответствующие методы.

 Вот темы, которые вам в конечном итоге нужно будет освоить:

- Использование COM-объектов в вашем языке программирования. См. документацию по языку программирования и разделы, относящиеся к конкретному языку, далее в этой документации.
-  Работа с COM-объектами, предоставляемыми .NET COM Interop. Видеть[Взаимодействие с неуправляемым кодом](https://docs.microsoft.com/en-us/dotnet/framework/interop/) а также[Предоставление компонентов .NET Framework для COM](https://docs.microsoft.com/en-us/dotnet/framework/interop/exposing-dotnet-components-to-com) в MSDN.
-  Aspose.Diagram Объектная модель документа. Видеть[Aspose.Diagram Руководство программиста](https://docs.aspose.com/diagram/net/developer-guide/) а также[API Ссылка](https://reference.aspose.com/diagram/net).
#### **Зарегистрируйте Aspose.Diagram for .NET с COM-взаимодействием**
Вам необходимо установить Aspose.Diagram for .NET и убедиться, что он зарегистрирован в COM-взаимодействии (чтобы его можно было вызывать из неуправляемого кода).

Чтобы зарегистрировать Aspose.Diagram for .NET для COM-взаимодействия вручную:

1.  От**Начинать** меню, выберите**Все программы** , тогда**Microsoft Визуальная студия**, **Инструменты Visual Studio** и наконец,**Командная строка Visual Studio**. В некоторых операционных системах он также доступен по адресу: "C:\Program Files (x86)\Microsoft SDK\Windows\v7.0A\bin\x64"
1.  Введите команду для регистрации сборки:
   1. .NET Framework 2.0
regasm "C:\Program Files\Aspose\Aspose.Diagram for .NET\bin\net2.0\Aspose.Diagram.dll" /codebase
   1. .NET Framework 3.5
 regasm "C:\Program Files\Aspose\Aspose.Diagram for .NET\bin\net3.5\Aspose.Diagram.dll" /codebase
   1. .NET Framework 4.0
 regasm "C:\Program Files\Aspose\Aspose.Diagram for .NET\bin\net4.0\Aspose.Diagram.dll" /codebase

{{% alert color="primary" %}} 

Обратите внимание, что /codebase необходим только в том случае, если Aspose.Diagram.dll нет в GAC, использование этой опции заставляет regasm указать путь для сборки в реестре.

{{% /alert %}} {{% alert color="primary" %}} 

 regasm.exe — это инструмент, включенный в .NET Framework SDK. Все инструменты SDK .NET Framework расположены в*\Microsoft .NET\Framework\<FrameworkVersion>* каталог, например*C:\Windows\Microsoft .NET\Framework\v4.0.30319*. Если вы используете Visual Studio .NET:
 От**Начинать** меню, выберите**Программы** , с последующим**Microsoft Visual Studio .NET** , тогда**Инструменты Visual Studio .NET** и наконец,**Visual Studio .NET 2003 Командная строка**.
Он запускает командную строку со всеми необходимыми переменными среды.

{{% /alert %}} 
##### **ProgID**
ProgID означает «программный идентификатор». Это имя класса COM, который используется для создания объекта. Идентификаторы ProgID состоят из имени библиотеки "Aspose.Diagram" и имени класса.
##### **Библиотека типов**
Если ваш язык программирования (например, Visual Basic или Delphi) позволяет ссылаться на библиотеку типов COM, добавьте ссылку на Aspose.Diagram.tlb и просмотрите все Aspose.Diagram for .NET классы, методы, свойства и перечисления в обозревателе объектов.

Чтобы создать файл TLB:

- .NET Framework 2.0
 regasm "C:\Program Files\Aspose\Aspose.Diagram for .NET\bin\net2.0\Aspose.Diagram.dll" /tlb: "C:\Program Files\Aspose\Aspose.Diagram for .NET\bin\net2.0\Aspose.Diagram.tlb" /codebase
- .NET Framework 3.5
 regasm "C:\Program Files\Aspose\Aspose.Diagram for .NET\bin\net3.5\Aspose.Diagram.dll" /tlb: "C:\Program Files\Aspose\Aspose.Diagram for .NET\bin\net3.5\Aspose.Diagram.tlb" /codebase
- .NET Framework 4.0
regasm "C:\Program Files\Aspose\Aspose.Diagram for .NET\bin\net4.0\Aspose.Diagram.dll" /tlb: "C:\Program Files\Aspose\Aspose.Diagram for .NET\bin\net4.0\Aspose.Diagram.tlb" /codebase
#### **Создание COM-объектов**
Создание COM-объекта аналогично созданию обычного объекта .NET. После создания вы можете получить доступ к методам и свойствам объекта, как если бы это был COM-объект.

Некоторые методы имеют перегруженные версии, и COM-взаимодействие будет отображать их с добавленным к ним числовым суффиксом, за исключением самого первого метода, который остается неизменным. Например, перегрузки метода Diagram.Save становятся Diagram.Save, Diagram.Save_2 и т. д.

{{% alert color="primary" %}} 

 Дополнительные сведения см. в статьях, посвященных конкретным языкам, далее в этой документации.

{{% /alert %}} 
## **Aspose.Diagram Ресурсы**
Ниже приведены ссылки на некоторые полезные ресурсы, которые могут вам понадобиться для выполнения ваших задач.
- [Aspose.Diagram for Java Онлайн-документация](https://docs.aspose.com/diagram/java/)
- [Aspose.Diagram для Node.js через онлайн-документацию Java](https://docs.aspose.com/diagram/nodejsjava/)
- [Aspose.Diagram для Python через онлайн-документацию Java](https://docs.aspose.com/diagram/pythonjava/)

##### **Создание сборки-оболочки**
Если вам нужно использовать многие из Aspose.Diagram for .NET классов, методов и свойств, рассмотрите возможность создания сборки-оболочки (используя C# или любой другой язык программирования .NET). Сборки-оболочки помогают избежать использования Aspose.Diagram for .NET непосредственно из неуправляемого кода.

Хорошим подходом является разработка сборки .NET, которая ссылается на Aspose.Diagram for .NET и выполняет всю работу с ним, предоставляя неуправляемому коду только минимальный набор классов и методов. Тогда ваше приложение должно работать только с вашей библиотекой-оболочкой.

 Сокращение количества классов и методов, которые необходимо вызывать через COM-взаимодействие, упрощает проект. Использование классов .NET через COM-взаимодействие часто требует дополнительных навыков.
## **Создайте пустой чертеж Visio в PHP с помощью COM Interop**
### **Предпосылки**
 Настройте свой PHP для работы с COM. Видеть<http://www.php.net/manual/en/ref.com.php> . Для получения дополнительной информации, пожалуйста, ознакомьтесь со статьей под названием[Используйте Aspose.Diagram for .NET через COM-взаимодействие](/diagram/ru/net/home/).
### **Создание пустого чертежа Visio**
 Это простое приложение показывает, как создать пустой чертеж Visio, используя[Aspose.Diagram for .NET](/diagram/ru/net/home/) в PHP через COM-взаимодействие.

**PHP**

{{< highlight "csharp" >}}

 <?php

echo "<h3>Calling Aspose.Diagram for .NET from PHP using COM Interoperatibility</h3>";

//set license

$lic = new COM("Aspose.Diagram.License");

$lic->SetLicense("D:\ASPOSE\Licences\Aspose.Total licenses\Aspose.Total.lic");

// create a new instance of Diagram object using COM interop

$diagram = new COM("Aspose.Diagram.Diagram");

// Save the Visio drawing in the VDX format

$diagram->Save("d:\diagramtest\MyOutput.vdx", 0);

?>



{{< /highlight >}}
