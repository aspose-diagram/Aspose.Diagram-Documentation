---
title: Работа с текстом
type: docs
weight: 90
url: /ru/net/working-with-text/
description: В этом разделе объясняется, как вставить текстовую фигуру или обновить текст фигуры с помощью Aspose.Diagram.
---
## **Вставьте текстовую фигуру на страницу Visio**
 Aspose.Diagram API позволяет разработчикам вставлять текст в любом месте страницы Visio. Для этого используется метод AddText класса[Страница](http://www.aspose.com/api/net/diagram/aspose.diagram/page) класс принимает параметры PinX, PinY, ширину, высоту и текст.
### **Вставка примера программирования формы текста**
Следующий фрагмент кода добавляет текстовую фигуру в Visio diagram.

{{< gist "aspose-diagram-gists" "efd56218048f8b0ab925efd494227fdd" "Examples-CSharp-Working-with-Text-InsertTextShape-InsertTextShape.cs" >}}
## **Обновление Visio Форма текста**
 Так же как[создание диаграмм](/diagram/ru/net/load-or-create-a-visio-drawing/) , Aspose.Diagram for .NET позволяет работать с фигурами по-разному. В этой статье рассматривается, как получить доступ к тексту в фигурах и обновить его. Свойство Text, предоставляемое[Форма](http://www.aspose.com/api/net/diagram/aspose.diagram/shape) class, поддерживает объект Aspose.Diagram.Text. Свойство можно использовать для извлечения или обновления текста фигуры. Процесс обновления текста фигуры прост:

1. Загрузите diagram.
1. Найдите определенную форму.
1. Установите новый текст.
1. Сохраните номер diagram.
### **Обновить пример программирования текста формы**
Следующий фрагмент кода обновляет текст фигуры. Фигуры идентифицируются по их идентификаторам. Приведенные ниже сегменты кода ищут фигуру с именем process и идентификатором 1 и изменяют ее текст.

{{< gist "aspose-diagram-gists" "efd56218048f8b0ab925efd494227fdd" "Examples-CSharp-Working-with-Text-UpdateShapeText-UpdateShapeText.cs" >}}
## **Применение встроенной или пользовательской таблицы стилей к фигуре Visio**
Microsoft Visio таблицы стилей хранят информацию о форматировании, которую можно применить к фигурам для единообразного внешнего вида. Aspose.Diagram for .NET позволяет применять таблицы стилей из приложения.

 Свойства TextStyle, FillStyle и LineStyle, предоставляемые[Форма](http://www.aspose.com/api/net/diagram/aspose.diagram/shape) класс поддерживает[Aspose.Diagram.StyleSheet](http://www.aspose.com/api/net/diagram/aspose.diagram/stylesheet) объект. Свойство можно использовать для получения информации о стиле и применения пользовательских стилей текста, линий и заливки к diagram.
### **Пользовательские стили в Microsoft Visio**
Чтобы применить пользовательские стили к фигурам в Microsoft Visio:

1. Откройте diagram в Microsoft Visio.
1.  Выбирать**Определить стили** от**Формат** меню (Visio 2007) или щелкните правой кнопкой мыши**Стили** в**Проводник по чертежам** окно и выберите**Определить стили** (Visio 2010).
1.  в**Определить стили** введите новое имя для пользовательской таблицы стилей. Например, CustomStyle1.
1.  Нажмите на**Текст**, **Линия** а также**Наполнять** кнопки для установки стилей текста, линий и заливки соответственно.
1.  Нажмите**ХОРОШО**.

После определения пользовательских таблиц стилей в Microsoft Visio используйте следующий код в приложении .NET, чтобы применить пользовательские стили к вашим фигурам. Обратите внимание, что приведенные ниже примеры кода вызывают пользовательскую таблицу стилей, определенную выше: вам необходимо знать имя и расположение применяемой таблицы. Чтобы применить пользовательские стили программно:

1. Загрузите diagram.
1. Найдите фигуру, к которой вы хотите применить стиль.
1. Загрузите таблицу стилей.
1. Применение стилей.
1. Сохраните номер diagram.
#### **Пример программирования применения пользовательских стилей**
{{< gist "aspose-diagram-gists" "efd56218048f8b0ab925efd494227fdd" "Examples-CSharp-Working-with-Text-ApplyCustomStyleSheets-ApplyCustomStyleSheets.cs" >}}
## **Применение разных стилей к каждому текстовому значению фигуры**
 Так же как[создание диаграмм](/diagram/ru/net/load-or-create-a-visio-drawing/), Aspose.Diagram for .NET позволяет работать с фигурами по-разному. Эта статья поможет добавить несколько текстовых значений в фигуру и применить разные стили к каждому текстовому значению.

{{% alert color="primary" %}} 

Элемент Shape содержит элемент Text, который содержит символы текста и специальные элементы (cp, pp, tp и fld), обозначающие конец одного цикла и начало следующего. Элемент Char содержит атрибуты форматирования текста фигуры, такие как шрифт, цвет, стиль текста, регистр, положение относительно базовой линии и размер точек.

{{% /alert %}} 
### **Добавление текста и стилей фигуры**

|**Ввод diagram**|
|:- |
|![дело:изображение_альтернативный_текст](working-with-text_1.png)|


|**Diagram после добавления различных текстовых значений в фигуру с различным стилем для каждого текстового значения**|
|:- |
|![дело:изображение_альтернативный_текст](working-with-text_2.png)|
#### **Пример программирования добавления текста и стилей**
Следующий фрагмент кода добавляет текст фигуры и различные стили.

{{< gist "aspose-diagram-gists" "efd56218048f8b0ab925efd494227fdd" "Examples-CSharp-Working-with-Text-ApplyFontOnText-ApplyFontOnText.cs" >}}
## **Найти и заменить текст фигуры**
[Текст](http://www.aspose.com/api/net/diagram/aspose.diagram/txt) Класс позволяет редактировать текст фигуры. Метод Replace, представленный[Текст](http://www.aspose.com/api/net/diagram/aspose.diagram/txt) class, поддержка изменения текста фигуры.
Примеры кода в этой статье находят и заменяют текст фигуры на странице.

|**Ввод diagram**|
|:- |
|![дело:изображение_альтернативный_текст](working-with-text_3.png)|


|**diagram после редактирования формы**|
|:- |
|![дело:изображение_альтернативный_текст](working-with-text_4.png)|
Процесс изменения текста фигуры:

1. Загрузите diagram.
1. Найдите конкретный текст фигуры.
1. Заменить текст этой формы
1. Сохраните номер diagram.
### **Пример программы поиска и замены текста**
Фрагменты кода ниже показывают, как изменить текст фигуры. Код перебирает формы страницы.

{{< gist "aspose-diagram-gists" "efd56218048f8b0ab925efd494227fdd" "Examples-CSharp-Working-with-Text-FindAndReplaceShapeText-FindAndReplaceShapeText.cs" >}}
## **Извлечь обычный текст со страницы Visio Diagram**
Aspose.Diagram API позволяет разработчикам извлекать обычный текст со страницы Visio diagram. Они также могут перебирать страницы Visio diagram, чтобы охватить весь текст Visio diagram.

 Microsoft Office Visio добавляет текст к фигурам.[Форма](http://www.aspose.com/api/net/diagram/aspose.diagram/shape) class содержит элемент с именем Text, который содержит символы текста и специальные элементы (cp, pp, tp и fld), отмечающие конец одного цикла и начало следующего.
### **Пример извлечения простого текста**
Следующий фрагмент кода перебирает формы страницы Visio и фильтрует обычный текст без информации о форматировании.

{{< gist "aspose-diagram-gists" "efd56218048f8b0ab925efd494227fdd" "Examples-CSharp-Working-with-Text-GetPlainTextOfVisio-GetPlainTextOfVisio.cs" >}}
